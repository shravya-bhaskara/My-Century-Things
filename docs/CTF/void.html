<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/w3css/3/w3.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
  
ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
  overflow: hidden;
  background-color: #cecece;
}

img{
	border-radius: 8px;
	display: block;
  	margin-left: auto;
  	margin-right: auto;
	width: 100%;
	max-width: 300px;
}
.writeup{
  width: 100%;
  max-width: 750px;
  padding: 10px;
  border: 5px solid gray;
  border-style: dotted solid;
  margin-left: auto;
  margin-right: auto;
	
}
ul.ingredients {
  list-style-type: circle;
}
	
li {
  float: left;
}

li.ingredients{
	text-align: left;
	}
li a, .dropbtn   {
  display: inline-block;
  color: white;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
}

li a:hover, .dropdown:hover .dropbtn {
  background-color: grey;
}

li.dropdown {
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: silver;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.dropdown-content a:hover {background-color: #f1f1f1;}

.dropdown:hover .dropdown-content {
  display: block;
}

h1{
   text-align:center;
   -webkit-text-decoration-line: overline underline; /* Safari */
   text-decoration-line: overline underline;
}
h2{
   text-decoration-line: underline;
}

	
</style>
</head>
<body>
 
 <ul>
  <li><a class="active" href="../index.html">Home</a></li>
  <li class="dropdown">
  	<a href="javascript:void(0)" class="droptn">Menu</a>
  	<div class="dropdown-content">
		<a href="../docs/CTF-writeup.html">CTF Writeups</a>
		<a href="#binaryexploitation">Binary Exploitation</a>
		<a href="#poemsandstories">Poems and Short Stories</a>
		<a href="../docs/food.html">Food</a>
	</div>
  </li>
  <li><a href="#contact">Contact</a></li>
  <li><a href="../docs/about.html">About</a></li>
  
 </ul>
<p>     </p>
<p>     </p>
<img src="../../images/tamuctf.jpg" width="350" height="263" alt="void">
<p>     </p>
<div class="writeup">
	<h1> Void</h1>
	<h2> Points: 272</h2>
		<p> This was one of the good challenges that I tried during the CTF. It was based on a technique called SROP (Sigreturn Oriented Programming). </p>

   <p>The purpose of this challenge was to defeat ASLR and so the binary as such consisted of only two functions - <code> main </code> and <code> _start </code> both written in simple assembly making use of syscalls. 
      I'll take you through challenge and how I solved it! </p>
	<h2> Preliminary Analysis: </h2>
   <blockquote><code>
void: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, BuildID[sha1]=7fd635b160836aff1b92af6f203e3b1f160f54cc, not stripped
      </code>
	<code>
		Canary                        : ✘ 
		NX                            : ✓ 
		PIE                           : ✘ 
		Fortify                       : ✘ 
		RelRO                         : ✘ 
		gef➤
	   </code>
	</blockquote>

	


<p> As we can see, it is a 64-bit statically linked binary and only NX is enabled! So we'll need to figure out a way to inject shellcode and execute, if at all we use that approach. We will see how that can be done soon enough!
	For now let's analyze the binary further! </p>

	<h2> Analysis </h2>
	<blockquote>
		<code>```
			gef➤  info functions
All defined functions:

Non-debugging symbols:
0x0000000000401000  main
0x0000000000401020  _start
gef➤  disas main
Dump of assembler code for function main:
   0x0000000000401000 <+0>:	mov    rax,0x0
   0x0000000000401007 <+7>:	mov    rdi,0x0
   0x000000000040100e <+14>:	mov    rsi,rsp
   0x0000000000401011 <+17>:	mov    rdx,0x7d0
   0x0000000000401018 <+24>:	syscall 
   0x000000000040101a <+26>:	ret    
End of assembler dump.
gef➤  disas _start
Dump of assembler code for function _start:
   0x0000000000401020 <+0>:	xor    eax,eax
   0x0000000000401022 <+2>:	call   0x401000 <main>
   0x0000000000401027 <+7>:	mov    rax,0x3c
   0x000000000040102e <+14>:	mov    rdi,0x0
   0x0000000000401035 <+21>:	syscall 
   0x0000000000401037 <+23>:	ret    
End of assembler dump.
gef➤ 
			```
	</code>
</blockquote>

</div>			
</body>
</html>
